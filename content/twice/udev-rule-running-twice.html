---
title: "The Best Udev Rule Running Twice References"
description: "To fix the issue do the following. (this is just the interesting portion)"
date: "2022-06-22"
categories:
  - "TWICE"
images: 
  - "https://i2.wp.com/forums.autodesk.com/autodesk/attachments/autodesk/120/87880/2/Rule looping_1.png"
featuredImage: "https://tse1.mm.bing.net/th?q=udev%20rule%20running%20twice"
featured_image: "https://tse1.mm.bing.net/th?q=udev%20rule%20running%20twice"
image: "https://i2.wp.com/forums.autodesk.com/autodesk/attachments/autodesk/120/87880/2/Rule looping_1.png"
---

<article>
    <p><strong>The Best Udev Rule Running Twice References</strong>. For now, we just identify the drive and run the test script. Subsystem==usb, action==add, run+=//root/usbmon/usb add %b subsystem==usb, action==remove, run+=//root/usbmon/usb remove %b</p>
        <figure>
        <noscript>
            <img src="https://forums.autodesk.com/t5/image/serverpage/image-id/537121iDD8F440A575043D2?v=v2" alt="Solved Rule looping, cyclus is wrongly running twice Autodesk Community" width="640" height="360" />
        </noscript>
        <img class="v-cover ads-img" src="https://forums.autodesk.com/t5/image/serverpage/image-id/537121iDD8F440A575043D2?v=v2" alt="Solved Rule looping, cyclus is wrongly running twice Autodesk Community" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <figcaption>Solved Rule looping, cyclus is wrongly running twice Autodesk Community from forums.autodesk.com</figcaption>
    </figure>
        <p>Packaging kernel modules/drivers using dkms. Ok, i’ve found the error! After getting the udev rule to work, i am sometimes running into trouble, where disconnecting an external monitor changes the profile to external monitor, and connecting an external monitor changes the profile to only my laptop.</p>
</article>
<!--more-->
<section>
    <aside>
        <img alt="iLogic, run rule twice to work Autodesk Community" src="https://forums.autodesk.com/autodesk/attachments/autodesk/120/65153/3/After.JPG" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://forums.autodesk.com/autodesk/attachments/autodesk/120/65153/3/After.JPG" >Download Image</a></p>
		<small>Source: <i>forums.autodesk.com</i></small>
        <p>If it cannot lock, it writes to the state file, and exits. Also your script may already run before kobo finished booting so the user.</p>
    </aside>
    <aside>
        <img alt="Solved Rule looping, cyclus is wrongly running twice Autodesk Community" src="https://forums.autodesk.com/t5/image/serverpage/image-id/537121iDD8F440A575043D2?v=v2" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://forums.autodesk.com/t5/image/serverpage/image-id/537121iDD8F440A575043D2?v=v2" >Download Image</a></p>
		<small>Source: <i>forums.autodesk.com</i></small>
        <p>You can run it with an udev rule, but udev might trigger it multiple times (so you need some locking mechanism) and there&#039;s also a case where long running scripts are terminated, so the scripts might need to daemonize itself too. When the command finishes, it checks the state file, and if it exists it loops and runs the command again.</p>
    </aside>
    <aside>
        <img alt="Why does my udev rule run several times? YouTube" src="https://i.ytimg.com/vi/6s5C9fnW0tg/maxresdefault.jpg" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://i.ytimg.com/vi/6s5C9fnW0tg/maxresdefault.jpg" >Download Image</a></p>
		<small>Source: <i>www.youtube.com</i></small>
        <p>Subsystem==usb, action==add, run+=//root/usbmon/usb add %b subsystem==usb, action==remove, run+=//root/usbmon/usb remove %b I tried to make udev rules for the nuc i just moved to but that didn’t seem to work.</p>
    </aside>
    <aside>
        <img alt="VirtualBox Creating Backups &amp; Clones Of Running Virtual Machines (No Downtime) With LVM Snapshots" src="https://www.howtoforge.com/images/live_backup_of_running_virtualbox_vm_with_lvm_snapshots/big/13.png" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://www.howtoforge.com/images/live_backup_of_running_virtualbox_vm_with_lvm_snapshots/big/13.png" >Download Image</a></p>
		<small>Source: <i>www.howtoforge.com</i></small>
        <p>Subsystem==usb, action==add, run+=//root/usbmon/usb add %b subsystem==usb, action==remove, run+=//root/usbmon/usb remove %b After getting the udev rule to work, i am sometimes running into trouble, where disconnecting an external monitor changes the profile to external monitor, and connecting an external monitor changes the profile to only my laptop.</p>
    </aside>
    <aside>
        <img alt="Solved Rule looping, cyclus is wrongly running twice Autodesk Community" src="https://forums.autodesk.com/autodesk/attachments/autodesk/120/87880/2/Rule looping_1.png" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://forums.autodesk.com/autodesk/attachments/autodesk/120/87880/2/Rule looping_1.png" >Download Image</a></p>
		<small>Source: <i>forums.autodesk.com</i></small>
        <p>We tried the red hat solution id# 495013, but it did not work. To see what udev does, you can run test and observe the output:</p>
    </aside>
    <aside>
        <img alt="Prevent rule from running twice in 30 minutes Rule Machine® Hubitat" src="https://community.hubitat.com/uploads/default/optimized/3X/6/2/6241f5ecd26189a1fa82040a105878b2f8912db5_2_928x750.png" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://community.hubitat.com/uploads/default/optimized/3X/6/2/6241f5ecd26189a1fa82040a105878b2f8912db5_2_928x750.png" >Download Image</a></p>
		<small>Source: <i>community.hubitat.com</i></small>
        <p>Ask question asked 8 years ago active 8 years ago viewed 2k times 2 i want to when i plug an usb device to my laptop, a script will be run just one time. The resulting behavior is that when the kernel requests a firmware, /lib/udev/firmware.sh is run twice at the same time.</p>
    </aside>
    <aside>
        <img alt="Solved Rule looping, cyclus is wrongly running twice Autodesk Community" src="https://forums.autodesk.com/autodesk/attachments/autodesk/120/87931/1/1_Running%20twice_21.08.2018.png" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://forums.autodesk.com/autodesk/attachments/autodesk/120/87931/1/1_Running%20twice_21.08.2018.png" >Download Image</a></p>
		<small>Source: <i>forums.autodesk.com</i></small>
        <p>This occurs because the script run for the sdc and the sdc1 events. That do the job, but when i read the log file, it seems that the archive script is executed 3 times when i plug my key.</p>
    </aside>
    <aside>
        <img alt="udev rule to run Python script YouTube" src="https://i.ytimg.com/vi/a2XEaGPZDzc/maxresdefault.jpg" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://i.ytimg.com/vi/a2XEaGPZDzc/maxresdefault.jpg" >Download Image</a></p>
		<small>Source: <i>www.youtube.com</i></small>
        <p>It looks like i have to make the rule more specific, to match only one device. So i use the udev rules system in ubuntu 12.04.</p>
    </aside>
    <aside>
        <img alt="Solved Rule looping, cyclus is wrongly running twice Autodesk Community" src="https://forums.autodesk.com/t5/image/serverpage/image-id/537120i4FA6A8691514D58B?v=v2" width="100%" style="margin-right: 8px;margin-bottom: 8px;" />
        <p align="center"><a rel="nofollow" target="_blank" href="https://forums.autodesk.com/t5/image/serverpage/image-id/537120i4FA6A8691514D58B?v=v2" >Download Image</a></p>
		<small>Source: <i>forums.autodesk.com</i></small>
        <p>If it cannot lock, it writes to the state file, and exits. (this is just the interesting portion)</p>
    </aside>
</section>
<section>
        <h3>That Do The Job, But When I Read The Log File, It Seems That The Archive Script Is Executed 3 Times When I Plug My Key.</h3>
    <br/>
    <p>Why does my udev rule run several times? It works by locking a known filename, clearing a state file, and then running the command. This command is recommended to trigger the rules file:</p>
        <h3>And Two Dev Files Are Created, Since Udev Calls This Rule Twice:</h3>
    <br/>
    <p>You can run it with an udev rule, but udev might trigger it multiple times (so you need some locking mechanism) and there&#039;s also a case where long running scripts are terminated, so the scripts might need to daemonize itself too. Ok, i’ve found the error! Packaging kernel modules/drivers using dkms.</p>
        <h3>I Tried To Make Udev Rules For The Nuc I Just Moved To But That Didn’t Seem To Work.</h3>
    <br/>
    <p>Hardware drivers on linux need to fit to the running kernel. This means that if two events come in hours apart, it is run twice. That’s part of the logic to keep network interface names stable even as interfaces are added or removed.</p>
        <h3>While This May Be Ok To Do Once Or Twice It Soon Becomes Tedious Doing It After Every Kernel Update.</h3>
    <br/>
    <p>However, this script is not thread safe at all. I have rebooted twice and still have it at /dev/ttyacm0. Because of some update from ubuntu 14.10 to 15.04 the syntax of udev rules changed and now it doesn’t parse %k variable.</p>
        <h3>Comparing Output At That Node:</h3>
    <br/>
    <p>The only problem i am facing is that the script is executed twice, even after using run=. What should i do for it to display only once? The problem is that this rule is applied twice and in the log appears annoying line:</p>
</section>
